<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next.js WordPress Documentation</title>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #131825;
            --bg-tertiary: #1a1f35;
            --bg-hover: #252b45;
            --text-primary: #e8eaed;
            --text-secondary: #9aa0b8;
            --accent-primary: #667eea;
            --border-color: #2a3150;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 320px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .sidebar-header {
            padding: 24px 20px;
            background: var(--gradient-1);
        }

        .sidebar-header h1 {
            font-size: 20px;
            color: white;
        }

        .sidebar-header p {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 4px;
        }

        .nav-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px 16px;
        }

        .nav-link {
            display: block;
            padding: 10px 12px;
            font-size: 14px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 4px;
        }

        .nav-link:hover,
        .nav-link.active {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-header {
            padding: 20px 32px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .content-body {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
        }

        .markdown-content {
            max-width: 900px;
            margin: 0 auto;
        }

        .markdown-content h1 {
            font-size: 36px;
            margin-bottom: 24px;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .markdown-content h2 {
            font-size: 28px;
            margin-top: 48px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
        }

        .markdown-content pre {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: 12px;
            margin: 24px 0;
            border: 1px solid var(--border-color);
        }

        .markdown-content code {
            background: var(--bg-tertiary);
            padding: 3px 8px;
            border-radius: 4px;
            color: #f093fb;
        }

        .tree-structure {
            font-family: monospace;
        }

        .tree-icon {
            color: var(--accent-primary);
        }

        .tree-folder {
            color: #f093fb;
        }

        .tree-file {
            color: #a8dadc;
        }

        .mermaid-container {
            position: relative;
            background: var(--bg-tertiary);
            padding: 30px;
            border-radius: 12px;
            margin: 24px 0;
            border: 1px solid var(--border-color);
        }

        .mermaid {
            display: inline-block;
        }

        .mermaid-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            z-index: 10;
        }

        .mermaid-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-primary);
        }

        .fullscreen-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
        }

        .fullscreen-modal.active {
            display: block;
        }

        .fullscreen-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 80px 20px 60px;
        }

        .fullscreen-diagram {
            cursor: grab;
            max-width: none !important;
            max-height: none !important;
        }

        .fullscreen-diagram:active {
            cursor: grabbing;
        }

        .fullscreen-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 12px;
            z-index: 10000;
        }

        .fs-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
        }

        .fs-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-primary);
        }

        .zoom-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>Next.js WordPress</h1>
                <p>Headless CMS Documentation</p>
            </div>
            <nav class="nav-list" id="navList"></nav>
        </aside>

        <main class="main-content">
            <header class="content-header">
                <div id="breadcrumb">Documentation</div>
            </header>
            <div class="content-body" id="contentBody">
                <div>Loading...</div>
            </div>
        </main>
    </div>

    <div class="fullscreen-modal" id="fsModal">
        <div class="fullscreen-controls">
            <button class="fs-btn" onclick="zoomDiagram(-0.3)">− Zoom Out</button>
            <button class="fs-btn" onclick="resetZoom()">⟲ Reset</button>
            <button class="fs-btn" onclick="zoomDiagram(0.3)">+ Zoom In</button>
            <button class="fs-btn" onclick="closeFullscreen()">✕ Close</button>
        </div>
        <div class="zoom-indicator" id="zoomIndicator">100%</div>
        <div class="fullscreen-content">
            <div class="fullscreen-diagram" id="fsContent"></div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#e8eaed',
                lineColor: '#9aa0b8',
                background: '#1a1f35'
            }
        });

        const nav = [
            { id: '1-overview', title: 'Overview', file: 'Overview.md', padding: 0 },
            { id: '2-getting-started', title: 'Getting Started', file: 'Getting-Started.md', padding: 0 },
            { id: '2.1-environment-configuration', title: 'Environment Configuration', file: 'Environment-Configuration.md', padding: 12 },
            { id: '2.2-development-commands', title: 'Development Commands', file: 'Development-Commands.md', padding: 12 },
            { id: '3-architecture', title: 'Architecture', file: 'Architecture.md', padding: 0 },
            { id: '3.1-type-system', title: 'Type System', file: 'Type-System.md', padding: 12 },
            { id: '3.2-data-flow', title: 'Data Flow', file: 'Data-Flow.md', padding: 12 },
            { id: '3.3-caching-and-revalidation', title: 'Caching and Revalidation', file: 'Caching-and-Revalidation.md', padding: 12 },
            { id: '4-frontend-application', title: 'Frontend Application', file: 'Frontend-Application.md', padding: 0 },
            { id: '4.1-pages-and-routing', title: 'Pages and Routing', file: 'Pages-and-Routing.md', padding: 12 },
            { id: '4.2-components', title: 'Components', file: 'Components.md', padding: 12 },
            { id: '4.3-layouts-and-metadata', title: 'Layouts and Metadata', file: 'Layouts-and-Metadata.md', padding: 12 },
            { id: '5-data-access-layer', title: 'Data Access Layer', file: 'Data-Access-Layer.md', padding: 0 },
            { id: '5.1-graphql-queries', title: 'GraphQL Queries', file: 'GraphQL-Queries.md', padding: 12 },
            { id: '5.2-graphql-mutations', title: 'GraphQL Mutations', file: 'GraphQL-Mutations.md', padding: 12 },
            { id: '5.3-fetchgraphql-utility', title: 'fetchGraphQL Utility', file: 'fetchGraphQL-Utility.md', padding: 12 },
            { id: '5.4-search-functionality', title: 'Search Functionality', file: 'Search-Functionality.md', padding: 12 },
            { id: '6-wordpress-integration', title: 'WordPress Integration', file: 'WordPress-Integration.md', padding: 0 },
            { id: '6.1-wordpress-configuration', title: 'WordPress Configuration', file: 'WordPress-Configuration.md', padding: 12 },
            { id: '6.2-preview-mode', title: 'Preview Mode', file: 'Preview-Mode.md', padding: 12 },
            { id: '6.3-on-demand-revalidation', title: 'On-Demand Revalidation', file: 'On-Demand-Revalidation.md', padding: 12 },
            { id: '7-development-environment', title: 'Development Environment', file: 'Development-Environment.md', padding: 0 },
            { id: '7.1-vs-code-configuration', title: 'VS Code Configuration', file: 'VS-Code-Configuration.md', padding: 12 },
            { id: '7.2-code-quality-tools', title: 'Code Quality Tools', file: 'Code-Quality-Tools.md', padding: 12 },
            { id: '7.3-git-hooks', title: 'Git Hooks', file: 'Git-Hooks.md', padding: 12 },
            { id: '8-testing', title: 'Testing', file: 'Testing.md', padding: 0 },
            { id: '8.1-testing-infrastructure', title: 'Testing Infrastructure', file: 'Testing-Infrastructure.md', padding: 12 },
            { id: '8.2-writing-tests', title: 'Writing Tests', file: 'Writing-Tests.md', padding: 12 },
            { id: '8.3-test-coverage', title: 'Test Coverage', file: 'Test-Coverage.md', padding: 12 },
            { id: '9-build-and-deployment', title: 'Build and Deployment', file: 'Build-and-Deployment.md', padding: 0 },
            { id: '9.1-build-process', title: 'Build Process', file: 'Build-Process.md', padding: 12 },
            { id: '9.2-cicd-pipeline', title: 'CI/CD Pipeline', file: 'CI\\CD-Pipeline.md', padding: 12 },
            { id: '9.3-static-generation', title: 'Static Generation', file: 'Static-Generation.md', padding: 12 },
            { id: '10-seo-and-public-files', title: 'SEO and Public Files', file: 'SEO-and-Public-Files.md', padding: 0 },
            { id: '11-development-agents', title: 'Development Agents', file: 'Development-Agents.md', padding: 0 },
            { id: '12-typescript-configuration', title: 'TypeScript Configuration', file: 'TypeScript-Configuration.md', padding: 0 }
        ];

        let panzoom = null;

        document.getElementById('navList').innerHTML = nav.map(item =>
            `<a class="nav-link" href="#${item.id}" style="padding-left:${item.padding}px">${item.title}</a>`
        ).join('');

        async function loadPage(id) {
            const page = nav.find(p => p.id === id);
            if (!page) return;

            const res = await fetch(page.file);
            const md = await res.text();
            const html = marked.parse(md);

            document.getElementById('contentBody').innerHTML = `<div class="markdown-content">${html}</div>`;

            // Process trees
            document.querySelectorAll('pre code').forEach(block => {
                const text = block.textContent;
                if (text.includes('├──') || text.includes('└──')) {
                    block.innerHTML = text.split('\n').map(line => {
                        let l = line.replace(/([├└]──\s+)([^/\n]+\/)/g, '$1<span class="tree-folder">$2</span>');
                        l = l.replace(/([├└]──\s+)([^/\n<]+)$/gm, '$1<span class="tree-file">$2</span>');
                        l = l.replace(/(├──|└──|│)/g, '<span class="tree-icon">$1</span>');
                        return l;
                    }).join('\n');
                    block.parentElement.classList.add('tree-structure');
                }
            });

            // Process mermaid
            const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
            for (const block of mermaidBlocks) {
                const code = block.textContent;
                const container = document.createElement('div');
                container.className = 'mermaid-container';
                container.innerHTML = `
                    <button class="mermaid-btn" onclick="openFullscreen(this)">⛶ Fullscreen</button>
                    <div class="mermaid">${code}</div>
                `;
                block.parentElement.replaceWith(container);
            }

            if (document.querySelectorAll('.mermaid').length > 0) {
                await mermaid.run({ querySelector: '.markdown-content .mermaid' });
            }

            document.querySelectorAll('pre code:not(.language-mermaid)').forEach(block => {
                if (!block.closest('.tree-structure')) hljs.highlightElement(block);
            });

            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.toggle('active', link.getAttribute('href') === '#' + id);
            });
        }

        function openFullscreen(btn) {
            const diagram = btn.nextElementSibling.cloneNode(true);
            document.getElementById('fsContent').innerHTML = '';
            document.getElementById('fsContent').appendChild(diagram);
            document.getElementById('fsModal').classList.add('active');

            panzoom = Panzoom(diagram, {
                maxScale: 5,
                minScale: 0.5,
                contain: 'outside'
            });

            document.querySelector('.fullscreen-content').addEventListener('wheel', panzoom.zoomWithWheel);
            document.getElementById('zoomIndicator').textContent = '100%';
        }

        function closeFullscreen() {
            if (panzoom) {
                panzoom.destroy();
                panzoom = null;
            }
            document.getElementById('fsModal').classList.remove('active');
        }

        function zoomDiagram(delta) {
            if (panzoom) {
                panzoom.zoomIn({ step: delta });
                document.getElementById('zoomIndicator').textContent = Math.round(panzoom.getScale() * 100) + '%';
            }
        }

        function resetZoom() {
            if (panzoom) {
                panzoom.reset();
                document.getElementById('zoomIndicator').textContent = '100%';
            }
        }

        window.addEventListener('hashchange', () => {
            const id = location.hash.slice(1) || nav[0].id;
            loadPage(id);
        });

        document.addEventListener('keydown', e => {
            if (document.getElementById('fsModal').classList.contains('active')) {
                if (e.key === 'Escape') closeFullscreen();
                else if (e.key === '+' || e.key === '=') zoomDiagram(0.3);
                else if (e.key === '-') zoomDiagram(-0.3);
                else if (e.key === '0') resetZoom();
            }
        });

        loadPage(location.hash.slice(1) || nav[0].id);
    </script>
</body>

</html>